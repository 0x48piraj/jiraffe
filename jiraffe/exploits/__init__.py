#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import pkgutil
import importlib
import inspect

from jiraffe.exploits.base import Exploit


def load_exploits():
    exploits = []

    for module_info in pkgutil.iter_modules(__path__):
        if module_info.name == "base":
            continue

        module = importlib.import_module(
            f"{__name__}.{module_info.name}"
        )

        for _, obj in inspect.getmembers(module, inspect.isclass):
            if (
                issubclass(obj, Exploit)
                and obj is not Exploit
            ):
                exploits.append(obj)

    return exploits
